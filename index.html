<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¯¸ìˆ êµê³¼ ê¸°ë°˜ ì§€ì—­ì—°ê³„ í•™êµì˜ˆìˆ êµìœ¡ ì›Œí¬ìˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #F9F9F7;
            color: #333333;
        }
        .section-card {
            background-color: #FFFFFF;
            border-radius: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            border: 1px solid #EDEDED;
        }
        .nav-button {
            transition: all 0.3s ease;
            border-bottom: 4px solid transparent;
        }
        .nav-button.active {
            color: #4A90E2;
            border-bottom-color: #4A90E2;
        }
        .nav-button:hover {
            color: #4A90E2;
            background-color: #F0F5FA;
        }
        .case-card {
            perspective: 1000px;
        }
        .case-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        .case-card.flipped .case-card-inner {
            transform: rotateY(180deg);
        }
        .case-card-front, .case-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 0.75rem;
            padding: 1.5rem;
        }
        .case-card-front {
            background: linear-gradient(135deg, #f0f4f8, #d9e2ec);
            color: #334155;
        }
        .case-card-back {
            background-color: #ffffff;
            border: 1px solid #e2e8f0;
            transform: rotateY(180deg);
            overflow-y: auto;
            align-items: flex-start;
        }
        .step-indicator {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .step-indicator.active {
            background-color: #4A90E2;
            color: white;
            transform: scale(1.1);
        }
        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #D1D5DB;
            border-radius: 0.5rem;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .form-input:focus {
            outline: none;
            border-color: #4A90E2;
            box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.2);
        }
        .loading-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #4A90E2;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal.hidden {
            display: none;
        }
        .api-key-button {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background-color: #4A90E2;
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        .api-key-button:hover {
            background-color: #357ABD;
            transform: scale(1.1);
        }
        .api-key-button.active {
            background-color: #10B981;
        }
    </style>
</head>
<body>
    <!-- API í‚¤ ì„¤ì • ë²„íŠ¼ -->
    <button id="api-key-btn" class="api-key-button" title="API í‚¤ ì„¤ì •">ğŸ”‘</button>

    <!-- API í‚¤ ì„¤ì • ëª¨ë‹¬ -->
    <div id="api-modal" class="modal hidden">
        <div class="bg-white p-8 rounded-lg shadow-xl max-w-md w-full mx-4">
            <h3 class="text-xl font-bold text-gray-800 mb-4">ğŸ”‘ Gemini API í‚¤ ì„¤ì •</h3>
            
            <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mb-4">
                <h4 class="font-bold text-blue-800 mb-2">ğŸ“‹ API í‚¤ ë°œê¸‰ ë°©ë²•</h4>
                <ol class="text-sm text-blue-700 space-y-1 list-decimal list-inside">
                    <li><a href="https://aistudio.google.com/app/apikey" target="_blank" class="underline hover:text-blue-900">Google AI Studio</a>ì— ì ‘ì†</li>
                    <li>"Create API Key" ë²„íŠ¼ í´ë¦­</li>
                    <li>ìƒì„±ëœ API í‚¤ë¥¼ ì•„ë˜ì— ì…ë ¥</li>
                </ol>
            </div>
            
            <div class="space-y-4">
                <input type="password" id="api-key-input" class="form-input" placeholder="Gemini API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: AIzaSy...)">
                <div id="api-status" class="text-sm text-gray-600">API í‚¤ë¥¼ ì…ë ¥í•˜ë©´ AI ì¶”ì²œ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
                <div class="flex space-x-3">
                    <button id="api-save-btn" class="flex-1 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg">ì €ì¥</button>
                    <button id="api-cancel-btn" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg">ì·¨ì†Œ</button>
                </div>
            </div>
        </div>
    </div>

    <div class="container mx-auto px-4 py-8">
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-800">ë¯¸ìˆ êµê³¼ ê¸°ë°˜ ì§€ì—­ì—°ê³„ í•™êµì˜ˆìˆ êµìœ¡</h1>
            <p class="text-lg text-gray-500 mt-4">ì´ˆë“± êµì›ì„ ìœ„í•œ ì‹¤ìŠµ ì¤‘ì‹¬ ì›Œí¬ìˆ</p>
            
            <!-- API ìƒíƒœ í‘œì‹œ -->
            <div id="api-status-banner" class="mt-4 p-3 rounded-lg bg-yellow-50 border border-yellow-200 text-yellow-800 text-sm">
                âš ï¸ AI ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë ¤ë©´ ìš°ì¸¡ ìƒë‹¨ì˜ ğŸ”‘ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ API í‚¤ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.
            </div>
        </header>

        <nav class="sticky top-0 bg-white/80 backdrop-blur-sm z-10 shadow-sm rounded-lg mb-12">
            <div class="max-w-5xl mx-auto px-4">
                <div class="flex justify-center space-x-2 md:space-x-8">
                    <button data-target="intro" class="nav-button active font-semibold py-4 px-2 md:px-4 text-sm md:text-base">â° ì—°ìˆ˜ ì‹œì‘</button>
                    <button data-target="cases" class="nav-button font-semibold py-4 px-2 md:px-4 text-sm md:text-base">ğŸ¨ ì‚¬ë¡€ íƒêµ¬</button>
                    <button data-target="workshop" class="nav-button font-semibold py-4 px-2 md:px-4 text-sm md:text-base">ğŸ’¡ ìˆ˜ì—… ì„¤ê³„</button>
                    <button data-target="wrapup" class="nav-button font-semibold py-4 px-2 md:px-4 text-sm md:text-base">ğŸ“ ì •ë¦¬ ë° ê³µìœ </button>
                </div>
            </div>
        </nav>

        <main id="content-container">
            <!-- ì—°ìˆ˜ ì‹œì‘ ì„¹ì…˜ -->
            <section id="intro" class="content-section">
                <div class="max-w-4xl mx-auto section-card p-8 md:p-12">
                    <h2 class="text-3xl font-bold mb-6 text-gray-800">ğŸš€ í•¨ê»˜ ì‹œì‘í•˜ê¸°: ìš°ë¦¬ ë™ë„¤ ë³´ë¬¼ì°¾ê¸°</h2>
                    <p class="text-gray-600 mb-8 leading-relaxed">
                        ì•ˆë…•í•˜ì„¸ìš”, ì„ ìƒë‹˜! ì´ë²ˆ ì—°ìˆ˜ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤. ì´ ì‹œê°„ì€ ì´ë¡  í•™ìŠµì„ ë„˜ì–´, ì„ ìƒë‹˜ê»˜ì„œ ì§ì ‘ 'ì§€ì—­ì‚¬íšŒ'ë¼ëŠ” ì‚´ì•„ìˆëŠ” êµìœ¡ ìì›ì„ í™œìš©í•˜ì—¬ í•™ìƒë“¤ì„ ìœ„í•œ íŠ¹ë³„í•œ ë¯¸ìˆ  ìˆ˜ì—…ì„ ê¸°íší•˜ëŠ” ì‹¤ìŠµì˜ ì¥ì…ë‹ˆë‹¤.
                    </p>
                    <div class="bg-blue-50 border-l-4 border-blue-400 p-6 rounded-r-lg mb-8">
                        <h3 class="font-bold text-xl mb-2 text-blue-800">ì˜¤ëŠ˜ì˜ ì—°ìˆ˜ ëª©í‘œ</h3>
                        <ul class="list-disc list-inside text-blue-700 space-y-2">
                            <li>ì§€ì—­ì—°ê³„ ì˜ˆìˆ êµìœ¡ì˜ ê°œë…ê³¼ ê°€ì¹˜ë¥¼ ì´í•´í•©ë‹ˆë‹¤.</li>
                            <li>ë‹¤ì–‘í•œ ì„±ê³µ ì‚¬ë¡€ë¥¼ í†µí•´ ì•„ì´ë””ì–´ë¥¼ ì–»ìŠµë‹ˆë‹¤.</li>
                            <li>ë‚˜ë§Œì˜ ì§€ì—­ì—°ê³„ ë¯¸ìˆ  ìˆ˜ì—…ì„ ì§ì ‘ ì„¤ê³„í•˜ê³  êµ¬ì²´í™”í•©ë‹ˆë‹¤.</li>
                        </ul>
                    </div>
                    
                    <h3 class="font-bold text-2xl mb-4 text-gray-700">ICE-BREAKING: ìš°ë¦¬ í•™êµ 1km ë°˜ê²½ì—ëŠ”?</h3>
                    <p class="text-gray-600 mb-6">ìˆ˜ì—… ì„¤ê³„ë¥¼ ì‹œì‘í•˜ê¸° ì „, ì ì‹œ ìš°ë¦¬ í•™êµ ì£¼ë³€ì„ ë– ì˜¬ë ¤ë³¼ê¹Œìš”?</p>
                    <div class="flex flex-wrap gap-4 text-center">
                        <span class="bg-yellow-100 text-yellow-800 text-base font-medium px-4 py-2 rounded-full">ğŸŒ³ ê³µì›/ìˆ²</span>
                        <span class="bg-green-100 text-green-800 text-base font-medium px-4 py-2 rounded-full">ğŸ›ï¸ ì‘ì€ ë°•ë¬¼ê´€/ë¯¸ìˆ ê´€</span>
                        <span class="bg-indigo-100 text-indigo-800 text-base font-medium px-4 py-2 rounded-full">ì‹œì¥/ìƒì ê°€</span>
                        <span class="bg-purple-100 text-purple-800 text-base font-medium px-4 py-2 rounded-full">ğŸ§‘â€ğŸ¨ ì§€ì—­ ì˜ˆìˆ ê°€/ì¥ì¸</span>
                        <span class="bg-pink-100 text-pink-800 text-base font-medium px-4 py-2 rounded-full">ğŸ“œ ì˜¤ë˜ëœ ê±´ë¬¼/ì—­ì‚¬ ìœ ì </span>
                        <span class="bg-gray-200 text-gray-800 text-base font-medium px-4 py-2 rounded-full">ğŸ¢ ê³µê³µê¸°ê´€</span>
                    </div>
                </div>
            </section>

            <!-- ì‚¬ë¡€ íƒêµ¬ ì„¹ì…˜ -->
            <section id="cases" class="content-section hidden">
                <div class="max-w-5xl mx-auto section-card p-8 md:p-12">
                    <h2 class="text-3xl font-bold mb-2 text-gray-800">ğŸŒ ê°€ëŠ¥ì„±ì˜ ë°œê²¬: ì§€ì—­ì—°ê³„ êµìœ¡ ì‚¬ë¡€ íƒêµ¬</h2>
                    <p class="text-gray-600 mb-8 leading-relaxed">
                        ì´ë¯¸ ì „êµ­ì˜ ë§ì€ í•™êµì—ì„œ ì§€ì—­ì‚¬íšŒì˜ íŠ¹ì„±ì„ ì‚´ë¦° ì°½ì˜ì ì¸ ë¯¸ìˆ  êµìœ¡ì„ ì‹¤ì²œí•˜ê³  ìˆìŠµë‹ˆë‹¤. ê° ì¹´ë“œë¥¼ í´ë¦­í•˜ì—¬ ìì„¸í•œ ë‚´ìš©ì„ ì‚´í´ë³´ì„¸ìš”.
                    </p>
                    
                    <div class="grid md:grid-cols-2 gap-8 mb-12">
                        <div class="chart-container relative h-[300px]">
                            <canvas id="caseTypeChart"></canvas>
                        </div>
                        <div class="flex flex-col justify-center">
                            <h3 class="font-bold text-2xl mb-4 text-gray-700">ì‚¬ë¡€ ìœ í˜• ë¶„ì„</h3>
                            <p class="text-gray-600">ì§€ì—­ì—°ê³„ ìˆ˜ì—…ì€ ë‹¤ì–‘í•œ í˜•íƒœë¡œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. 'ê³µê³µë¯¸ìˆ  í”„ë¡œì íŠ¸'ì²˜ëŸ¼ í•™ìƒë“¤ì´ ì§ì ‘ ì§€ì—­ í™˜ê²½ ê°œì„ ì— ì°¸ì—¬í•˜ëŠ” í˜•íƒœê°€ ê°€ì¥ ë§ìœ¼ë©°, 'ì¥ì†Œ íƒë°©'ì´ë‚˜ 'ì „ë¬¸ê°€ í˜‘ë ¥' ìˆ˜ì—…ë„ í™œë°œíˆ ì´ë£¨ì–´ì§€ê³  ìˆìŠµë‹ˆë‹¤.</p>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="case-card h-64 cursor-pointer">
                            <div class="case-card-inner">
                                <div class="case-card-front">
                                    <h3 class="text-2xl font-bold">ê³µê³µë¯¸ìˆ  í”„ë¡œì íŠ¸</h3>
                                    <p class="mt-2">ìš°ë¦¬ ë™ë„¤ë¥¼ ìº”ë²„ìŠ¤ë¡œ!</p>
                                    <span class="mt-4 text-xs font-semibold">(í´ë¦­í•˜ì—¬ ìì„¸íˆ ë³´ê¸°)</span>
                                </div>
                                <div class="case-card-back text-left">
                                    <h4 class="font-bold text-lg mb-2">ë§ˆì„ ë²½í™” ê·¸ë¦¬ê¸°</h4>
                                    <p class="text-sm text-gray-600">
                                        <strong>ëŒ€ìƒ:</strong> 5~6í•™ë…„<br>
                                        <strong>ì—°ê³„ìì›:</strong> ì§€ì—­ ì£¼ë¯¼ì„¼í„°, ë…¸í›„ ë‹´ë²¼ë½<br>
                                        <strong>í™œë™:</strong> ìš°ë¦¬ ë™ë„¤ ì´ì•¼ê¸° ë¦¬ì„œì¹˜ â†’ ë””ìì¸ ì‹œì•ˆ ì œì‘ ë° ë°œí‘œ â†’ ì£¼ë¯¼ ì˜ê²¬ ìˆ˜ë ´ â†’ í•¨ê»˜ ë²½í™” ì œì‘<br>
                                        <strong>ì„±ê³¼:</strong> í™˜ê²½ ê°œì„ , ê³µë™ì²´ ì˜ì‹ í•¨ì–‘
                                    </p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="case-card h-64 cursor-pointer">
                            <div class="case-card-inner">
                                <div class="case-card-front">
                                    <h3 class="text-2xl font-bold">ì¥ì†Œ íƒë°© & ì¬í•´ì„</h3>
                                    <p class="mt-2">ìµìˆ™í•œ ê³µê°„, ìƒˆë¡­ê²Œ ë³´ê¸°</p>
                                    <span class="mt-4 text-xs font-semibold">(í´ë¦­í•˜ì—¬ ìì„¸íˆ ë³´ê¸°)</span>
                                </div>
                                <div class="case-card-back text-left">
                                    <h4 class="font-bold text-lg mb-2">ì „í†µì‹œì¥ ë“œë¡œì‰</h4>
                                    <p class="text-sm text-gray-600">
                                        <strong>ëŒ€ìƒ:</strong> 3~4í•™ë…„<br>
                                        <strong>ì—°ê³„ìì›:</strong> ì§€ì—­ ì „í†µì‹œì¥<br>
                                        <strong>í™œë™:</strong> ì‹œì¥ ë°©ë¬¸í•˜ì—¬ ì˜¤ê°ìœ¼ë¡œ ê´€ì°°í•˜ê¸° â†’ ìƒì¸ ì¸í„°ë·° ë° ì‚¬ì§„ ì´¬ì˜ â†’ ê°€ì¥ ì¸ìƒ ê¹Šì€ ëª¨ìŠµ ë“œë¡œì‰/ì½œë¼ì£¼ë¡œ í‘œí˜„ â†’ 'ìš°ë¦¬ ì‹œì¥ ì „ì‹œíšŒ' ê°œìµœ<br>
                                        <strong>ì„±ê³¼:</strong> ê´€ì°°ë ¥, í‘œí˜„ë ¥, ì§€ì—­ ê²½ì œ ì´í•´
                                    </p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="case-card h-64 cursor-pointer">
                            <div class="case-card-inner">
                                <div class="case-card-front">
                                    <h3 class="text-2xl font-bold">ì „ë¬¸ê°€ í˜‘ë ¥ ìˆ˜ì—…</h3>
                                    <p class="mt-2">ë§ˆì„ ì¥ì¸ì—ê²Œ í•œ ìˆ˜ ë°°ìš°ê¸°</p>
                                    <span class="mt-4 text-xs font-semibold">(í´ë¦­í•˜ì—¬ ìì„¸íˆ ë³´ê¸°)</span>
                                </div>
                                <div class="case-card-back text-left">
                                    <h4 class="font-bold text-lg mb-2">ë„ì˜ˆê°€ì™€ í•¨ê»˜í•˜ëŠ” ì»µ ë§Œë“¤ê¸°</h4>
                                    <p class="text-sm text-gray-600">
                                        <strong>ëŒ€ìƒ:</strong> ì „í•™ë…„<br>
                                        <strong>ì—°ê³„ìì›:</strong> ì§€ì—­ ë„ì˜ˆ ê³µë°© ì‘ê°€<br>
                                        <strong>í™œë™:</strong> ì‘ê°€ ì´ˆë¹™í•˜ì—¬ ì§ì—… ì´ì•¼ê¸° ë“£ê¸° â†’ í™ì˜ ì„±ì§ˆ íƒêµ¬ â†’ 1ì¸ 1ì»µ ë””ìì¸ ë° ì œì‘ â†’ ê°€ë§ˆ ì†Œì„± í›„ ì‘í’ˆ ê°ìƒ<br>
                                        <strong>ì„±ê³¼:</strong> ì§„ë¡œ íƒìƒ‰, ì¡°í˜• ëŠ¥ë ¥, ì¬ë£Œ ì´í•´
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ìˆ˜ì—… ì„¤ê³„ ì„¹ì…˜ -->
            <section id="workshop" class="content-section hidden">
                <div class="max-w-4xl mx-auto section-card p-8 md:p-12">
                    <h2 class="text-3xl font-bold mb-2 text-gray-800">ğŸ› ï¸ ë‚˜ë§Œì˜ ìˆ˜ì—… ì„¤ê³„í•˜ê¸°</h2>
                    <p class="text-gray-600 mb-8 leading-relaxed">
                        ì´ì œ ë³¸ê²©ì ìœ¼ë¡œ ì„ ìƒë‹˜ë§Œì˜ ì§€ì—­ì—°ê³„ ë¯¸ìˆ  ìˆ˜ì—…ì„ êµ¬ìƒí•  ì‹œê°„ì…ë‹ˆë‹¤. ì•„ë˜ 4ê°€ì§€ ë‹¨ê³„ë¥¼ ë”°ë¼ê°€ë©° ë¹ˆì¹¸ì„ ì±„ì›Œë³´ì„¸ìš”.
                    </p>

                    <div class="flex justify-around mb-8">
                        <div class="step-indicator w-16 h-16 flex items-center justify-center rounded-full border-2 border-gray-300 active" data-step="0">1</div>
                        <div class="step-indicator w-16 h-16 flex items-center justify-center rounded-full border-2 border-gray-300" data-step="1">2</div>
                        <div class="step-indicator w-16 h-16 flex items-center justify-center rounded-full border-2 border-gray-300" data-step="2">3</div>
                        <div class="step-indicator w-16 h-16 flex items-center justify-center rounded-full border-2 border-gray-300" data-step="3">4</div>
                    </div>
                    
                    <!-- 1ë‹¨ê³„: ìì› íƒìƒ‰ -->
                    <div id="step-0" class="workshop-step">
                        <h3 class="font-bold text-2xl mb-4 text-gray-700">1ë‹¨ê³„: ìš°ë¦¬ ë™ë„¤ ìì› íƒìƒ‰</h3>
                        <p class="text-gray-600 mb-6">ìš°ë¦¬ í•™êµ ì£¼ë³€ì—ì„œ ë¯¸ìˆ  ìˆ˜ì—…ê³¼ ì—°ê²°í•  ìˆ˜ ìˆëŠ” ìì›ì€ ë¬´ì—‡ì´ ìˆì„ê¹Œìš”?</p>
                        
                        <div class="mb-4">
                            <label class="block text-gray-700 text-sm font-bold mb-2">í•™ë…„ ì„ íƒ:</label>
                            <select id="grade-select" class="form-input">
                                <option value="">í•™ë…„ì„ ì„ íƒí•˜ì„¸ìš”</option>
                                <option value="1-2í•™ë…„">1-2í•™ë…„</option>
                                <option value="3-4í•™ë…„">3-4í•™ë…„</option>
                                <option value="5-6í•™ë…„">5-6í•™ë…„</option>
                            </select>
                        </div>
                        
                        <textarea id="resource-input" class="form-input" rows="4" placeholder="ììœ ë¡­ê²Œ ê¸°ë¡í•´ë³´ì„¸ìš”..."></textarea>
                        
                        <button id="suggest-ideas-btn" class="mt-4 bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-6 rounded-lg flex items-center disabled:opacity-50">
                            <span id="suggest-ideas-spinner" class="loading-spinner mr-2 hidden"></span>
                            âœ¨ ì•„ì´ë””ì–´ ì œì•ˆ ë°›ê¸°
                        </button>
                        <div id="suggested-ideas-output" class="mt-4 p-4 bg-indigo-50 border border-indigo-200 rounded-lg text-indigo-800 hidden"></div>
                        
                        <div class="mt-6 flex justify-end">
                            <button class="next-btn bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-lg">ë‹¤ìŒ ë‹¨ê³„ë¡œ</button>
                        </div>
                    </div>

                    <!-- 2ë‹¨ê³„: êµìœ¡ê³¼ì • ì—°ê²° -->
                    <div id="step-1" class="workshop-step hidden">
                        <h3 class="font-bold text-2xl mb-4 text-gray-700">2ë‹¨ê³„: êµìœ¡ê³¼ì • ì—°ê²° ë° ì£¼ì œ ì •í•˜ê¸°</h3>
                        
                        <div class="mb-4">
                            <label class="block text-gray-700 text-sm font-bold mb-2">ì„ íƒëœ ë™ë„¤ ìì›:</label>
                            <p id="selected-resource" class="form-input bg-gray-100 text-gray-600"></p>
                        </div>

                        <div class="mb-6">
                            <label class="block text-gray-700 text-sm font-bold mb-2">í•µì‹¬ ì—­ëŸ‰:</label>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                                <label class="flex items-center">
                                    <input type="checkbox" name="competency" value="ì‹¬ë¯¸ì  ê°ì„± ì—­ëŸ‰" class="mr-2">
                                    <span>ì‹¬ë¯¸ì  ê°ì„± ì—­ëŸ‰</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" name="competency" value="ì‹œê°ì  ì†Œí†µ ì—­ëŸ‰" class="mr-2">
                                    <span>ì‹œê°ì  ì†Œí†µ ì—­ëŸ‰</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" name="competency" value="ì°½ì˜âˆ™ìœµí•© ì—­ëŸ‰" class="mr-2">
                                    <span>ì°½ì˜âˆ™ìœµí•© ì—­ëŸ‰</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" name="competency" value="ê³µë™ì²´ ì—­ëŸ‰" class="mr-2">
                                    <span>ê³µë™ì²´ ì—­ëŸ‰</span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-gray-700 text-sm font-bold mb-2">í•™ìŠµ ì£¼ì œ:</label>
                            <textarea id="topic-input" class="form-input" rows="2" placeholder="ìˆ˜ì—… ì£¼ì œë¥¼ ê¸°ë¡í•´ë³´ì„¸ìš”..."></textarea>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-gray-700 text-sm font-bold mb-2">í•™ìŠµ ëª©í‘œ:</label>
                            <textarea id="objectives-input" class="form-input" rows="4" placeholder="í•™ìŠµ ëª©í‘œë¥¼ êµ¬ì²´ì ìœ¼ë¡œ ì‘ì„±í•´ë³´ì„¸ìš”..."></textarea>
                            <button id="suggest-objectives-btn" class="mt-2 bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg flex items-center disabled:opacity-50">
                                <span id="suggest-objectives-spinner" class="loading-spinner mr-2 hidden"></span>
                                âœ¨ í•™ìŠµ ëª©í‘œ ì œì•ˆ
                            </button>
                            <div id="suggested-objectives-output" class="mt-4 p-4 bg-indigo-50 border border-indigo-200 rounded-lg text-indigo-800 hidden"></div>
                        </div>

                        <div class="mt-6 flex justify-between">
                            <button class="prev-btn bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-6 rounded-lg">ì´ì „ ë‹¨ê³„ë¡œ</button>
                            <button class="next-btn bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-lg">ë‹¤ìŒ ë‹¨ê³„ë¡œ</button>
                        </div>
                    </div>

                    <!-- 3ë‹¨ê³„: í™œë™ êµ¬ì²´í™” -->
                    <div id="step-2" class="workshop-step hidden">
                        <h3 class="font-bold text-2xl mb-4 text-gray-700">3ë‹¨ê³„: í™œë™ ë‚´ìš© êµ¬ì²´í™”</h3>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-bold mb-2">ë„ì…:</label>
                                <textarea id="intro-input" class="form-input" rows="3" placeholder="í¥ë¯¸ ìœ ë°œ, ë™ê¸° ë¶€ì—¬ í™œë™..."></textarea>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-bold mb-2">ì „ê°œ:</label>
                                <textarea id="main-input" class="form-input" rows="6" placeholder="í•µì‹¬ íƒêµ¬ ë° í‘œí˜„ í™œë™..."></textarea>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-bold mb-2">ì •ë¦¬:</label>
                                <textarea id="wrap-input" class="form-input" rows="3" placeholder="ì‘í’ˆ ê³µìœ , ëŠë‚€ ì  ë‚˜ëˆ„ê¸°..."></textarea>
                            </div>
                        </div>

                        <button id="suggest-activities-btn" class="mt-4 bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-6 rounded-lg flex items-center disabled:opacity-50">
                            <span id="suggest-activities-spinner" class="loading-spinner mr-2 hidden"></span>
                            âœ¨ í™œë™ ì•„ì´ë””ì–´ ì œì•ˆ
                        </button>
                        <div id="suggested-activities-output" class="mt-4 p-4 bg-indigo-50 border border-indigo-200 rounded-lg text-indigo-800 hidden"></div>

                        <div class="mt-6 flex justify-between">
                            <button class="prev-btn bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-6 rounded-lg">ì´ì „ ë‹¨ê³„ë¡œ</button>
                            <button class="next-btn bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-lg">ë‹¤ìŒ ë‹¨ê³„ë¡œ</button>
                        </div>
                    </div>

                    <!-- 4ë‹¨ê³„: ê¸°ëŒ€ íš¨ê³¼ -->
                    <div id="step-3" class="workshop-step hidden">
                        <h3 class="font-bold text-2xl mb-4 text-gray-700">4ë‹¨ê³„: ê¸°ëŒ€ íš¨ê³¼ ë° í™•ì¥ ë°©ì•ˆ</h3>
                        
                        <div class="mb-4">
                            <label class="block text-gray-700 text-sm font-bold mb-2">ê¸°ëŒ€ íš¨ê³¼:</label>
                            <textarea id="effects-input" class="form-input" rows="4" placeholder="ì´ ìˆ˜ì—…ì˜ ê¸°ëŒ€íš¨ê³¼ë¥¼ ê¸°ë¡í•´ë³´ì„¸ìš”..."></textarea>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-gray-700 text-sm font-bold mb-2">í™•ì¥ ë°©ì•ˆ:</label>
                            <textarea id="expansion-input" class="form-input" rows="4" placeholder="ìˆ˜ì—…ì˜ í™•ì¥ ë°©ì•ˆì„ ê¸°ë¡í•´ë³´ì„¸ìš”..."></textarea>
                            <button id="suggest-expansion-btn" class="mt-2 bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg flex items-center disabled:opacity-50">
                                <span id="suggest-expansion-spinner" class="loading-spinner mr-2 hidden"></span>
                                âœ¨ í™•ì¥ ë°©ì•ˆ ì œì•ˆ
                            </button>
                            <div id="suggested-expansion-output" class="mt-4 p-4 bg-indigo-50 border border-indigo-200 rounded-lg text-indigo-800 hidden"></div>
                        </div>

                        <div class="mt-6 flex justify-between">
                            <button class="prev-btn bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-6 rounded-lg">ì´ì „ ë‹¨ê³„ë¡œ</button>
                            <button id="complete-btn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-lg">ìˆ˜ì—… ì„¤ê³„ ì™„ë£Œ!</button>
                        </div>
                    </div>
                    
                    <!-- ì™„ë£Œ ë·° -->
                    <div id="complete-view" class="hidden mt-8 bg-gray-50 p-6 rounded-lg">
                        <h3 class="text-2xl font-bold text-center mb-6">ğŸ‰ ë‚˜ë§Œì˜ ìˆ˜ì—… ê³„íšì•ˆì´ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤!</h3>
                        <div id="summary-content" class="space-y-4 text-gray-700"></div>
                        <div class="mt-6 flex justify-center space-x-4">
                            <button id="reset-btn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-6 rounded-lg">ì´ˆê¸°í™”</button>
                            <button id="download-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg">ê³„íšì„œ ë‹¤ìš´ë¡œë“œ</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ì •ë¦¬ ë° ê³µìœ  ì„¹ì…˜ -->
            <section id="wrapup" class="content-section hidden">
                <div class="max-w-4xl mx-auto section-card p-8 md:p-12">
                    <h2 class="text-3xl font-bold mb-6 text-gray-800">ğŸŒ± ì•„ì´ë””ì–´ ê³µìœ  ë° ë§ˆë¬´ë¦¬</h2>
                    <p class="text-gray-600 mb-8 leading-relaxed">
                        ëª¨ë‘ ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤. ì„ ìƒë‹˜ë“¤ê»˜ì„œ ë§Œë“¤ì–´ì£¼ì‹  ìˆ˜ì—… ê³„íšì˜ ì´ˆì•ˆë“¤ì€ ì •ë§ ì†Œì¤‘í•œ ê²°ê³¼ë¬¼ì…ë‹ˆë‹¤.
                    </p>
                    
                    <div class="bg-green-50 border-l-4 border-green-400 p-6 rounded-r-lg">
                        <h3 class="font-bold text-xl mb-2 text-green-800">í† ì˜ ì£¼ì œ</h3>
                        <ul class="list-disc list-inside text-green-700 space-y-2">
                            <li>ê°€ì¥ ì¸ìƒ ê¹Šì—ˆë˜ ë™ë£Œ ì„ ìƒë‹˜ì˜ ìˆ˜ì—… ì•„ì´ë””ì–´ëŠ” ë¬´ì—‡ì¸ê°€ìš”?</li>
                            <li>ìˆ˜ì—…ì„ ì‹¤í–‰í•  ë•Œ ì˜ˆìƒë˜ëŠ” ì–´ë ¤ì›€ê³¼ í•´ê²° ë°©ì•ˆì€ ë¬´ì—‡ì¼ê¹Œìš”?</li>
                            <li>ìš°ë¦¬ ì§€ì—­ì˜ ìˆ¨ê²¨ì§„ ì˜ˆìˆ  ìì›ì—ëŠ” ë˜ ë¬´ì—‡ì´ ìˆì„ê¹Œìš”?</li>
                        </ul>
                    </div>
                </div>
            </section>
        </main>

        <footer class="mt-12 py-6 text-center text-gray-500 text-sm border-t border-gray-200">
            <p>&copy; Copyright Yang Inseon. All rights reserved.</p>
            <p class="mt-2">ë³¸ ì½”ë“œëŠ” ìˆ˜ì—… ì„¤ê³„ ë° í™œìš©ì„ ìœ„í•œ ëª©ì ìœ¼ë¡œ ì œê³µë©ë‹ˆë‹¤.</p>
        </footer>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let currentStep = 0;
        let apiKey = '';
        const workshopData = {
            grade: '',
            resource: '',
            competencies: [],
            topic: '',
            objectives: '',
            intro: '',
            main: '',
            wrap: '',
            effects: '',
            expansion: ''
        };

        // DOM ìš”ì†Œë“¤
        const elements = {
            apiKeyBtn: document.getElementById('api-key-btn'),
            apiModal: document.getElementById('api-modal'),
            apiKeyInput: document.getElementById('api-key-input'),
            apiSaveBtn: document.getElementById('api-save-btn'),
            apiCancelBtn: document.getElementById('api-cancel-btn'),
            apiStatusBanner: document.getElementById('api-status-banner'),
            navButtons: document.querySelectorAll('.nav-button'),
            contentSections: document.querySelectorAll('.content-section'),
            caseCards: document.querySelectorAll('.case-card'),
            stepIndicators: document.querySelectorAll('.step-indicator'),
            workshopSteps: document.querySelectorAll('.workshop-step'),
            nextBtns: document.querySelectorAll('.next-btn'),
            prevBtns: document.querySelectorAll('.prev-btn')
        };

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            setupEventListeners();
            setupChart();
            disableAIButtons();
        }

        function setupEventListeners() {
            // API í‚¤ ê´€ë ¨
            elements.apiKeyBtn?.addEventListener('click', () => showModal());
            elements.apiCancelBtn?.addEventListener('click', () => hideModal());
            elements.apiSaveBtn?.addEventListener('click', () => saveApiKey());
            elements.apiModal?.addEventListener('click', (e) => {
                if (e.target === elements.apiModal) hideModal();
            });

            // ë„¤ë¹„ê²Œì´ì…˜
            elements.navButtons.forEach(btn => {
                btn.addEventListener('click', () => switchSection(btn.dataset.target));
            });

            // ì¼€ì´ìŠ¤ ì¹´ë“œ ë’¤ì§‘ê¸°
            elements.caseCards.forEach(card => {
                card.addEventListener('click', () => card.classList.toggle('flipped'));
            });

            // ì›Œí¬ìƒµ ë‹¨ê³„ ë„¤ë¹„ê²Œì´ì…˜
            elements.stepIndicators.forEach((indicator, index) => {
                indicator.addEventListener('click', () => goToStep(index));
            });

            elements.nextBtns.forEach(btn => {
                btn.addEventListener('click', () => nextStep());
            });

            elements.prevBtns.forEach(btn => {
                btn.addEventListener('click', () => prevStep());
            });

            // AI ê¸°ëŠ¥ ë²„íŠ¼ë“¤
            setupAIButtons();

            // ì™„ë£Œ ë° ë¦¬ì…‹ ë²„íŠ¼
            document.getElementById('complete-btn')?.addEventListener('click', () => completeWorkshop());
            document.getElementById('reset-btn')?.addEventListener('click', () => resetWorkshop());
            document.getElementById('download-btn')?.addEventListener('click', () => downloadPlan());
        }

        function setupAIButtons() {
            const aiButtons = [
                { id: 'suggest-ideas-btn', handler: suggestIdeas },
                { id: 'suggest-objectives-btn', handler: suggestObjectives },
                { id: 'suggest-activities-btn', handler: suggestActivities },
                { id: 'suggest-expansion-btn', handler: suggestExpansion }
            ];

            aiButtons.forEach(({ id, handler }) => {
                const btn = document.getElementById(id);
                if (btn) btn.addEventListener('click', handler);
            });
        }

        // API í‚¤ ê´€ë¦¬
        function showModal() {
            elements.apiModal?.classList.remove('hidden');
            elements.apiKeyInput?.focus();
        }

        function hideModal() {
            elements.apiModal?.classList.add('hidden');
            if (elements.apiKeyInput) elements.apiKeyInput.value = '';
        }

        function saveApiKey() {
            const key = elements.apiKeyInput?.value.trim();
            if (!key || key.length < 20 || !key.startsWith('AIza')) {
                showStatus('ì˜¬ë°”ë¥¸ API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }

            apiKey = key;
            hideModal();
            
            // UI ì—…ë°ì´íŠ¸
            elements.apiKeyBtn?.classList.add('active');
            elements.apiStatusBanner.innerHTML = 'âœ… API í‚¤ê°€ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì œ AI ì¶”ì²œ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
            elements.apiStatusBanner.className = 'mt-4 p-3 rounded-lg bg-green-50 border border-green-200 text-green-800 text-sm';
            
            enableAIButtons();
        }

        function showStatus(message, type = 'info') {
            const statusEl = document.getElementById('api-status');
            if (statusEl) {
                statusEl.textContent = message;
                statusEl.className = `text-sm ${type === 'error' ? 'text-red-600' : 'text-gray-600'}`;
            }
        }

        // AI ë²„íŠ¼ í™œì„±í™”/ë¹„í™œì„±í™”
        function enableAIButtons() {
            const aiButtons = document.querySelectorAll('[id*="suggest-"]');
            aiButtons.forEach(btn => {
                btn.disabled = false;
                btn.classList.remove('opacity-50');
            });
        }

        function disableAIButtons() {
            const aiButtons = document.querySelectorAll('[id*="suggest-"]');
            aiButtons.forEach(btn => {
                btn.disabled = true;
                btn.classList.add('opacity-50');
            });
        }

        // ì°¨íŠ¸ ì„¤ì •
        function setupChart() {
            const canvas = document.getElementById('caseTypeChart');
            if (!canvas) return;

            try {
                const ctx = canvas.getContext('2d');
                new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['ê³µê³µë¯¸ìˆ  í”„ë¡œì íŠ¸', 'ì¥ì†Œ íƒë°© & ì¬í•´ì„', 'ì „ë¬¸ê°€ í˜‘ë ¥', 'ì§€ì—­ ë¬¸í™”ìœ ì‚° ì¬í•´ì„', 'ìƒíƒœ ë¯¸ìˆ  í”„ë¡œì íŠ¸'],
                        datasets: [{
                            data: [25, 20, 20, 20, 15],
                            backgroundColor: [
                                'rgba(74, 144, 226, 0.7)',
                                'rgba(80, 227, 194, 0.7)',
                                'rgba(186, 104, 200, 0.7)',
                                'rgba(255, 159, 64, 0.7)',
                                'rgba(75, 192, 192, 0.7)'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: { display: true, text: 'ì§€ì—­ì—°ê³„ êµìœ¡ ì‚¬ë¡€ ìœ í˜• ë¶„í¬' }
                        }
                    }
                });
            } catch (error) {
                console.error('ì°¨íŠ¸ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
            }
        }

        // ì„¹ì…˜ ì „í™˜
        function switchSection(targetId) {
            elements.navButtons.forEach(btn => btn.classList.remove('active'));
            elements.contentSections.forEach(section => section.classList.add('hidden'));

            const targetBtn = document.querySelector(`[data-target="${targetId}"]`);
            const targetSection = document.getElementById(targetId);

            if (targetBtn) targetBtn.classList.add('active');
            if (targetSection) targetSection.classList.remove('hidden');

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // ì›Œí¬ìƒµ ë‹¨ê³„ ê´€ë¦¬
        function goToStep(stepIndex) {
            if (stepIndex < 0 || stepIndex > 3) return;
            
            saveCurrentStepData();
            currentStep = stepIndex;
            updateStepView();
        }

        function nextStep() {
            if (currentStep < 3) {
                saveCurrentStepData();
                currentStep++;
                updateStepView();
            }
        }

        function prevStep() {
            if (currentStep > 0) {
                saveCurrentStepData();
                currentStep--;
                updateStepView();
            }
        }

        function updateStepView() {
            // ë‹¨ê³„ í‘œì‹œê¸° ì—…ë°ì´íŠ¸
            elements.stepIndicators.forEach((indicator, index) => {
                indicator.classList.toggle('active', index === currentStep);
            });

            // ë‹¨ê³„ ì»¨í…ì¸  ì—…ë°ì´íŠ¸
            elements.workshopSteps.forEach((step, index) => {
                step.classList.toggle('hidden', index !== currentStep);
            });

            // ë°ì´í„° ë¡œë“œ
            loadStepData();
        }

        function saveCurrentStepData() {
            switch (currentStep) {
                case 0:
                    workshopData.grade = document.getElementById('grade-select')?.value || '';
                    workshopData.resource = document.getElementById('resource-input')?.value || '';
                    break;
                case 1:
                    workshopData.competencies = Array.from(document.querySelectorAll('input[name="competency"]:checked'))
                        .map(cb => cb.value);
                    workshopData.topic = document.getElementById('topic-input')?.value || '';
                    workshopData.objectives = document.getElementById('objectives-input')?.value || '';
                    break;
                case 2:
                    workshopData.intro = document.getElementById('intro-input')?.value || '';
                    workshopData.main = document.getElementById('main-input')?.value || '';
                    workshopData.wrap = document.getElementById('wrap-input')?.value || '';
                    break;
                case 3:
                    workshopData.effects = document.getElementById('effects-input')?.value || '';
                    workshopData.expansion = document.getElementById('expansion-input')?.value || '';
                    break;
            }
        }

        function loadStepData() {
            switch (currentStep) {
                case 0:
                    if (document.getElementById('grade-select')) {
                        document.getElementById('grade-select').value = workshopData.grade;
                    }
                    if (document.getElementById('resource-input')) {
                        document.getElementById('resource-input').value = workshopData.resource;
                    }
                    break;
                case 1:
                    // ì„ íƒëœ ìì› í‘œì‹œ
                    const selectedResourceEl = document.getElementById('selected-resource');
                    if (selectedResourceEl) {
                        selectedResourceEl.textContent = workshopData.resource || 'ì…ë ¥ëœ ìì› ì—†ìŒ';
                    }
                    
                    // ì—­ëŸ‰ ì²´í¬ë°•ìŠ¤ ë³µì›
                    document.querySelectorAll('input[name="competency"]').forEach(cb => {
                        cb.checked = workshopData.competencies.includes(cb.value);
                    });
                    
                    if (document.getElementById('topic-input')) {
                        document.getElementById('topic-input').value = workshopData.topic;
                    }
                    if (document.getElementById('objectives-input')) {
                        document.getElementById('objectives-input').value = workshopData.objectives;
                    }
                    break;
                case 2:
                    if (document.getElementById('intro-input')) {
                        document.getElementById('intro-input').value = workshopData.intro;
                    }
                    if (document.getElementById('main-input')) {
                        document.getElementById('main-input').value = workshopData.main;
                    }
                    if (document.getElementById('wrap-input')) {
                        document.getElementById('wrap-input').value = workshopData.wrap;
                    }
                    break;
                case 3:
                    if (document.getElementById('effects-input')) {
                        document.getElementById('effects-input').value = workshopData.effects;
                    }
                    if (document.getElementById('expansion-input')) {
                        document.getElementById('expansion-input').value = workshopData.expansion;
                    }
                    break;
            }
        }

        // AI ê¸°ëŠ¥ë“¤
        async function callGeminiAPI(prompt, outputElementId, spinnerId) {
            if (!apiKey) {
                showOutput(outputElementId, '<p class="text-red-600">API í‚¤ë¥¼ ë¨¼ì € ì„¤ì •í•´ì£¼ì„¸ìš”.</p>');
                return;
            }

            const spinner = document.getElementById(spinnerId);
            const output = document.getElementById(outputElementId);

            if (spinner) spinner.classList.remove('hidden');
            if (output) output.classList.add('hidden');

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }] }],
                        generationConfig: {
                            temperature: 0.7,
                            maxOutputTokens: 1024
                        }
                    })
                });

                if (!response.ok) throw new Error(`API ì˜¤ë¥˜: ${response.status}`);

                const result = await response.json();
                const text = result.candidates?.[0]?.content?.parts?.[0]?.text;

                if (text) {
                    showOutput(outputElementId, `<h4 class="font-bold mb-2">âœ¨ AI ì œì•ˆ:</h4><div>${formatAIResponse(text)}</div>`);
                } else {
                    showOutput(outputElementId, '<p class="text-red-600">ì‘ë‹µì„ ìƒì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>');
                }
            } catch (error) {
                console.error('API í˜¸ì¶œ ì‹¤íŒ¨:', error);
                showOutput(outputElementId, `<p class="text-red-600">ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}</p>`);
            } finally {
                if (spinner) spinner.classList.add('hidden');
            }
        }

        function showOutput(elementId, content) {
            const element = document.getElementById(elementId);
            if (element) {
                element.innerHTML = content;
                element.classList.remove('hidden');
            }
        }

        function formatAIResponse(text) {
            return text.replace(/\n/g, '<br>').replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
        }

        async function suggestIdeas() {
            const grade = document.getElementById('grade-select')?.value;
            const resource = document.getElementById('resource-input')?.value;

            if (!grade || !resource) {
                showOutput('suggested-ideas-output', '<p class="text-red-600">í•™ë…„ê³¼ ì§€ì—­ ìì›ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>');
                return;
            }

            const prompt = `ì´ˆë“±í•™êµ ${grade} í•™ìƒë“¤ì´ '${resource}' ìì›ì„ í™œìš©í•œ ì°½ì˜ì ì¸ ë¯¸ìˆ  í™œë™ ì•„ì´ë””ì–´ 3ê°€ì§€ë¥¼ ì œì•ˆí•´ì£¼ì„¸ìš”.`;
            await callGeminiAPI(prompt, 'suggested-ideas-output', 'suggest-ideas-spinner');
        }

        async function suggestObjectives() {
            const grade = workshopData.grade;
            const resource = workshopData.resource;
            const topic = document.getElementById('topic-input')?.value;

            if (!grade || !resource || !topic) {
                showOutput('suggested-objectives-output', '<p class="text-red-600">í•„ìˆ˜ ì •ë³´ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>');
                return;
            }

            const prompt = `ì´ˆë“±í•™êµ ${grade} í•™ìƒë“¤ì´ '${resource}' ìì›ì„ í™œìš©í•˜ì—¬ '${topic}' ì£¼ì œë¡œ ë¯¸ìˆ  ìˆ˜ì—…ì„ í•  ë•Œì˜ êµ¬ì²´ì ì¸ í•™ìŠµ ëª©í‘œ 3ê°€ì§€ë¥¼ ì œì•ˆí•´ì£¼ì„¸ìš”.`;
            await callGeminiAPI(prompt, 'suggested-objectives-output', 'suggest-objectives-spinner');
        }

        async function suggestActivities() {
            const grade = workshopData.grade;
            const topic = workshopData.topic;
            const objectives = workshopData.objectives;

            if (!grade || !topic || !objectives) {
                showOutput('suggested-activities-output', '<p class="text-red-600">í•„ìˆ˜ ì •ë³´ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>');
                return;
            }

            const prompt = `ì´ˆë“±í•™êµ ${grade} í•™ìƒë“¤ì´ '${topic}' ì£¼ì œë¡œ ë¯¸ìˆ  ìˆ˜ì—…ì„ í•  ë•Œ, ë„ì…-ì „ê°œ-ì •ë¦¬ ë‹¨ê³„ë³„ êµ¬ì²´ì ì¸ í™œë™ ì•„ì´ë””ì–´ë¥¼ ì œì•ˆí•´ì£¼ì„¸ìš”.`;
            await callGeminiAPI(prompt, 'suggested-activities-output', 'suggest-activities-spinner');
        }

        async function suggestExpansion() {
            const grade = workshopData.grade;
            const topic = workshopData.topic;
            const effects = document.getElementById('effects-input')?.value;

            if (!grade || !topic || !effects) {
                showOutput('suggested-expansion-output', '<p class="text-red-600">í•„ìˆ˜ ì •ë³´ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>');
                return;
            }

            const prompt = `ì´ˆë“±í•™êµ ${grade}ì˜ '${topic}' ë¯¸ìˆ  ìˆ˜ì—…ì„ ë‹¤ë¥¸ êµê³¼ë‚˜ í™œë™ìœ¼ë¡œ í™•ì¥í•  ìˆ˜ ìˆëŠ” ë°©ì•ˆì„ 3ê°€ì§€ ì œì•ˆí•´ì£¼ì„¸ìš”.`;
            await callGeminiAPI(prompt, 'suggested-expansion-output', 'suggest-expansion-spinner');
        }

        // ì›Œí¬ìƒµ ì™„ë£Œ
        function completeWorkshop() {
            saveCurrentStepData();
            
            // ìš”ì•½ ìƒì„±
            const summary = generateSummary();
            document.getElementById('summary-content').innerHTML = summary;
            
            // ì™„ë£Œ ë·° í‘œì‹œ
            elements.workshopSteps.forEach(step => step.classList.add('hidden'));
            document.getElementById('complete-view')?.classList.remove('hidden');
        }

        function generateSummary() {
            return `
                <p><strong>í•™ë…„:</strong> ${workshopData.grade || 'ë¯¸ì…ë ¥'}</p>
                <p><strong>ë™ë„¤ ìì›:</strong> ${workshopData.resource || 'ë¯¸ì…ë ¥'}</p>
                <p><strong>í•µì‹¬ ì—­ëŸ‰:</strong> ${workshopData.competencies.join(', ') || 'ë¯¸ì„ íƒ'}</p>
                <p><strong>í•™ìŠµ ì£¼ì œ:</strong> ${workshopData.topic || 'ë¯¸ì…ë ¥'}</p>
                <p><strong>í•™ìŠµ ëª©í‘œ:</strong> ${workshopData.objectives || 'ë¯¸ì…ë ¥'}</p>
                <p><strong>ë„ì… í™œë™:</strong> ${workshopData.intro || 'ë¯¸ì…ë ¥'}</p>
                <p><strong>ì „ê°œ í™œë™:</strong> ${workshopData.main || 'ë¯¸ì…ë ¥'}</p>
                <p><strong>ì •ë¦¬ í™œë™:</strong> ${workshopData.wrap || 'ë¯¸ì…ë ¥'}</p>
                <p><strong>ê¸°ëŒ€ íš¨ê³¼:</strong> ${workshopData.effects || 'ë¯¸ì…ë ¥'}</p>
                <p><strong>í™•ì¥ ë°©ì•ˆ:</strong> ${workshopData.expansion || 'ë¯¸ì…ë ¥'}</p>
            `;
        }

        // ì´ˆê¸°í™”
        function resetWorkshop() {
            if (!confirm('ëª¨ë“  ì…ë ¥ ë‚´ìš©ì´ ì‚­ì œë©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

            // ë°ì´í„° ì´ˆê¸°í™”
            Object.keys(workshopData).forEach(key => {
                workshopData[key] = Array.isArray(workshopData[key]) ? [] : '';
            });

            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            document.querySelectorAll('input, textarea, select').forEach(el => {
                if (el.type === 'checkbox') el.checked = false;
                else el.value = '';
            });

            // AI ì¶œë ¥ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('[id$="-output"]').forEach(el => {
                el.classList.add('hidden');
            });

            // ì²« ë‹¨ê³„ë¡œ ì´ë™
            currentStep = 0;
            updateStepView();
            
            // ì™„ë£Œ ë·° ìˆ¨ê¸°ê¸°
            document.getElementById('complete-view')?.classList.add('hidden');
        }

        // ë‹¤ìš´ë¡œë“œ
        function downloadPlan() {
            const content = generateHTMLContent();
            const blob = new Blob([content], { type: 'text/html;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ë¯¸ìˆ ìˆ˜ì—…ê³„íšì•ˆ_${new Date().toISOString().slice(0, 10)}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function generateHTMLContent() {
            return `
                <!DOCTYPE html>
                <html lang="ko">
                <head>
                    <meta charset="UTF-8">
                    <title>ë¯¸ìˆ  ìˆ˜ì—… ê³„íšì•ˆ</title>
                    <style>
                        body { font-family: 'Noto Sans KR', sans-serif; margin: 20px; line-height: 1.6; }
                        h1 { color: #2C3E50; text-align: center; margin-bottom: 30px; }
                        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; vertical-align: top; }
                        th { background-color: #f0f4f8; font-weight: bold; width: 25%; }
                    </style>
                </head>
                <body>
                    <h1>ë¯¸ìˆ  ìˆ˜ì—… ê³„íšì•ˆ</h1>
                    <table>
                        <tr><th>í•™ë…„</th><td>${workshopData.grade}</td></tr>
                        <tr><th>ë™ë„¤ ìì›</th><td>${workshopData.resource}</td></tr>
                        <tr><th>í•µì‹¬ ì—­ëŸ‰</th><td>${workshopData.competencies.join(', ')}</td></tr>
                        <tr><th>í•™ìŠµ ì£¼ì œ</th><td>${workshopData.topic}</td></tr>
                        <tr><th>í•™ìŠµ ëª©í‘œ</th><td>${workshopData.objectives.replace(/\n/g, '<br>')}</td></tr>
                        <tr><th>ë„ì… í™œë™</th><td>${workshopData.intro.replace(/\n/g, '<br>')}</td></tr>
                        <tr><th>ì „ê°œ í™œë™</th><td>${workshopData.main.replace(/\n/g, '<br>')}</td></tr>
                        <tr><th>ì •ë¦¬ í™œë™</th><td>${workshopData.wrap.replace(/\n/g, '<br>')}</td></tr>
                        <tr><th>ê¸°ëŒ€ íš¨ê³¼</th><td>${workshopData.effects.replace(/\n/g, '<br>')}</td></tr>
                        <tr><th>í™•ì¥ ë°©ì•ˆ</th><td>${workshopData.expansion.replace(/\n/g, '<br>')}</td></tr>
                    </table>
                </body>
                </html>
            `;
        }
    </script>
</body>
</html>
